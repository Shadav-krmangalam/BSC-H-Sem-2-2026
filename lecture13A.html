<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promise Chaining - B</title>
</head>
<body>
    <script>

        let cart = [];

        function createOrder(cart){
            console.log("Creating Order...")

            return new Promise((resolve,reject)=>{
             setTimeout(()=>{
                   if(cart.length>0){
                    resolve({
                        orderID:1234,
                        amount:25000
                    })
                }else{
                    reject("Cart is Empty")
                }

             },5000)

            })

        }


        function makePayment(order){
            console.log("Initializing Payment....")
            return new Promise((resolve,reject)=>{
                setTimeout(()=>{
                    let network = true
                    if(network){
                        resolve({
                            ...order,
                            paymentID : "pay123"
                        })
                    }else{
                        reject("Payment Failed")
                    }

                },3000)
            })

        }

        function updateInventory(order){
            console.log("Updating Inventory...")
            return new Promise((resolve,reject)=>{
                let inventoryAvailable = true;

                setTimeout(()=>{
                    if(inventoryAvailable){
                    resolve({
                        ...order,
                        inventoryUpdated:true
                    })
                }else{
                    reject("Inventory is not available")
                }

                },4000)
            })
        }

        function orderStatus(order){
            console.log("Sending Order Status...")
            return new Promise((resolve,reject)=>{
                let message = true;

              setTimeout(()=>{
                  if(message){
                    resolve({
                        ...order,
                        orderStatus: "confirmed"
                    })
                }else{
                    reject("Order Cancelled")
                }
              },5000)
            })
        }

        createOrder(cart)
                   .then((order)=>{
                       console.log("Order Created for ",order)
                       return makePayment(order)

                        }).then((order)=>{
                            console.log("Payment Successful :",order)
                            return updateInventory(order)
                        }).then((order)=>{
                            console.log("Inventory Updated",order)
                            return orderStatus(order)
                        }).then((order)=>{
                            console.log("Order Status & Final Order : ",order)

                        }).catch((err)=>console.log(err));




    </script>
    
</body>
</html>